"use strict";(()=>{var e={};e.id=111,e.ids=[111],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7633:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>m,originalPathname:()=>v,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>f});var a={};r.r(a),r.d(a,{GET:()=>c});var o=r(5419),i=r(9108),n=r(9678),s=r(8070),u=r(8093);async function c(e){let{searchParams:t}=new URL(e.url),r=t.get("code");if(!r)return s.Z.json({error:"Code required"},{status:400});try{let e=await u._.room.findUnique({where:{code:r.toUpperCase()},include:{players:!0}});if(!e)return s.Z.json({error:"Room not found"},{status:404});let t={A:0,B:0};if("VOTING"===e.status||"REVEAL"===e.status){let r=JSON.parse(e.bracketState).rounds[e.currentRound];if(r&&r.matches[e.currentMatch]){let a=r.matches[e.currentMatch].id,o=await u._.vote.findMany({where:{matchId:a}}),i=r.matches[e.currentMatch];t.A=o.filter(e=>e.choice===i.nameA).length,t.B=o.filter(e=>e.choice===i.nameB).length}}return s.Z.json({...e,currentVotes:t})}catch(e){return console.error("Failed to fetch state:",e),s.Z.json({error:"Failed to fetch state"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/live/state/route",pathname:"/api/live/state",filename:"route",bundlePath:"app/api/live/state/route"},resolvedPagePath:"/Users/qaneahmed/PregLife/preglife/baby-name-deathmatch/app/api/live/state/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:h,headerHooks:m,staticGenerationBailout:f}=l,v="/api/live/state/route";function g(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:p})}},8093:(e,t,r)=>{r.d(t,{_:()=>o});let a=require("@prisma/client"),o=global.prisma||new a.PrismaClient({log:["query"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,206],()=>r(7633));module.exports=a})();